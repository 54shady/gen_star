# global variable
# run this script on the android source code top dir

# marco
ANDROID_TOP_DIR=$PWD
UBOOT_TOP_DIR="$ANDROID_TOP_DIR/u-boot"
UBOOT_OUT_DIR="$ANDROID_TOP_DIR/out/target/product/rk3288/obj/UBOOT"
LOCAL_CROSS_COMPILE="$ANDROID_TOP_DIR/prebuilts/gcc/linux-x86/arm/arm-eabi-4.6/bin/arm-eabi-"
BUILD_JOBS="-j8"

# suck things
RK_TOOLS="$UBOOT_TOP_DIR/tools/rk_tools"

# do compile for rk3288
genu_rk3288()
{
	# local variable
	KERNEL_CONFIG_FILE="rk3288_defconfig"

	# okay, it's time to do the real thing
	# generate dot config file if not exist
	if [ ! -f $UBOOT_OUT_DIR/.config ]
	then
		make -C $UBOOT_TOP_DIR ARCH=arm CROSS_COMPILE=$LOCAL_CROSS_COMPILE O=$UBOOT_OUT_DIR $KERNEL_CONFIG_FILE
	fi

	mkdir -p $UBOOT_OUT_DIR/tools
	cp -rvdf $RK_TOOLS $UBOOT_OUT_DIR/tools/

	# make uboot
	make -C $UBOOT_TOP_DIR ARCH=arm CROSS_COMPILE=$LOCAL_CROSS_COMPILE O=$UBOOT_OUT_DIR $KERNEL_TARGET_IMAGE $BUILD_JOBS
}

# let's get things done
genu_rk3288
